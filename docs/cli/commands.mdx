---
title: Commands
description: Learn how to use the Basin CLI.
---

The Recall CLI is a command-line interface for interacting with the Recall network. It allows you to
manage your accounts, interact with smart contracts, and manage your data that gets stored on the
network.

## Global options

All the global flags can also be passed as all-caps (prefixed with `RECALL_`), snake case
environment variables that are set, or create and source them in a `env` file. For example,
`--network` => `RECALL_NETWORK`, `--private-key` => `RECALL_PRIVATE_KEY`, etc.

| Flag              | Description                                             | Env. variable          |
| ----------------- | ------------------------------------------------------- | ---------------------- |
| `-n`, `--network` | Network presets for subnet and RPC (default: `testnet`) | `RECALL_NETWORK`       |
| `-s`, `--subnet`  | The ID of the target subnet.                            | `RECALL_SUBNET`        |
| `--rpc-url`       | Node CometBFT RPC URL.                                  | `RECALL_RPC_URL`       |
| `-v, --verbosity` | Logging verbosity (repeat for more verbosity).          | `RECALL_LOG_VERBOSITY` |
| `-q, --quiet`     | Silence logging (default: `false`).                     | `RECALL_LOG_QUIET`     |
| `-h, --help`      | Print help.                                             | -                      |
| `-V, --version`   | Print version.                                          | -                      |

### Environment variables

The following environment variables are required for the majority of the `recall` subcommands:

- `RECALL_PRIVATE_KEY`: A wallet private key (ECDSA, secp256k1) for signing transactions.
- `RECALL_NETWORK`: Specify the chain location with RPC presets and settings that map to either
  `mainnet` (not available), `testnet`, `localnet`, or `devnet`.

As such, the examples below omit these flags and presume that you've already set them.

## Account management

Interaction with the Recall network requires an account (ECDSA, secp256k1). As with any blockchain
system, an account can be created at will, transfer funds, and send transactions. Recall that Recall
runs on a polyglot execution environment, supporting both EVM and Wasm. Accounts work a bit
different than pure EVM environments because the account is "unknown" to the chain until a
transaction is sent to it. A transaction can be a deposit, `withdrawal`, or (intra-subnet) transfer.

Generally, you should _always_ opt for using an EVM `0x` address when you run account commands. EVM
accounts are also mapped to the Wasm environment's address space, which is an address that gets
prefixed with `t410...` (or `f410...` on mainnet) and
[specially encoded](https://docs.filecoin.io/smart-contracts/filecoin-evm-runtime/address-types#ethereum-address-manager)
for full EVM-compatability in the Wasm runtime.

The `account` command allows you to execute various subcommands:

```
recall account
```

The following `account` subcommands are available:

- `create`: Create a new account with a private key.
- `info`: Get account information (address, sequence, balance).
- `deposit`: Deposit funds into a subnet from its parent.
- `withdraw`: Withdraw funds from a subnet to its parent.
- `transfer`: Transfer funds to another account in a subnet.
- `sponsor`: Set or unset an account's default credit sponsor for gas fees.

### Create an account

Create a new account from a random seed.

```
recall account create
```

This command logs a JSON object to stdout with three properties: the private key, EVM public key,
and its corresponding Wasm compatible address.

**Example:**

Create a new private key:

```
> recall account create

{
  "private_key": "d5020dd0b12d4d8d8793ff0edbaa29bd7197879ddf82d475b7e9a6a34de765b0",
  "address": "0xc37ab532c1409900520a92e04a6c0482394d3133",
  "fvm_address": "t410fyn5lkmwbicmqauqkslqeu3aeqi4u2mjturajlui"
}
```

- Optionally, pipe its output into a file to store the keys:

```
> recall account create > account.json
```

### Get account info

Get account information, such as its address, nonce, and balance.

```
recall account info {--private-key <PRIVATE_KEY> | --address <ADDRESS>}
```

This commands logs a JSON object to stdout: its public key, addresses, current sequence (nonce),
current subnet balance, and its balance on the parent subnet.

| Flag                   | Required?                | Description                                                           |
| ---------------------- | ------------------------ | --------------------------------------------------------------------- |
| `-p, --private-key`    | Yes, if no `address`     | Wallet private key (ECDSA, secp256k1) for signing transactions.       |
| `-a, --address`        | Yes, if no `private-key` | Account address; the signer's address is used if no address is given. |
| `--height`             | No                       | Query at a specific block height (default: `committed`).              |
| `--evm-rpc-url`        | No                       | The Ethereum API RPC HTTP endpoint.                                   |
| `--evm-rpc-timeout`    | No                       | Timeout for calls to the Ethereum API (default: `60 seconds`).        |
| `--evm-rpc-auth-token` | No                       | Bearer token for any Authorization header.                            |
| `--evm-gateway`        | No                       | The gateway contract address.                                         |
| `--evm-registry`       | No                       | The registry contract address.                                        |
| `--evm-supply-source`  | No                       | The supply source contract address.                                   |

**Example:**

Get account info for a specific address:

```
> recall account info \
--address 0x4D5286d81317E284Cd377cB98b478552Bbe641ae

{
  "address": "0x4d5286d81317e284cd377cb98b478552bbe641ae",
  "fvm_address": "t410fjvjinwatc7rijtjxps4ywr4fkk56mqnolzpcnrq",
  "sequence": 0,
  "balance": "1.0",
  "parent_balance": "327.239162949816051546"
}
```

### Deposit funds

Deposit funds into a subnet from its parent.

```
recall account deposit [--to <TO>] <AMOUNT>
```

Think of the `deposit` command as transferring funds from a parent to a child subnet. If you want to
build on Recall, you start by moving funds from the parent L1 (rootnet) to the Recall subnet. This
goes through a smart contract (i.e., the gateway contract) call that locks the funds in a smart
contract on the parent, later minting them to the address on the subnet (i.e., a bridging flow).

| Positionals | Description             |
| ----------- | ----------------------- |
| `<AMOUNT>`  | The amount to transfer. |

Optionally, you can pass the `--to` flag to deposit funds from the parent to a specific address on
the child. If you don't specify anything, the funds will be deposited to the address corresponding
to the provided private key. Note that the global `--network` flag (defaults to `testnet`) will set
all of the `--evm-...` presets for you, but you _can_ override them with your own values, if needed.

| Flag                   | Required? | Description                                                                       |
| ---------------------- | --------- | --------------------------------------------------------------------------------- |
| `-p, --private-key`    | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions.                   |
| `--to <TO>`            | No        | The recipient account address (if not present, defaults to the signer's address). |
| `--evm-rpc-url`        | No        | The Ethereum API RPC HTTP endpoint.                                               |
| `--evm-rpc-timeout`    | No        | Timeout for calls to the Ethereum API (default: `60 seconds`).                    |
| `--evm-rpc-auth-token` | No        | Bearer token for any Authorization header.                                        |
| `--evm-gateway`        | No        | The gateway contract address.                                                     |
| `--evm-registry`       | No        | The registry contract address.                                                    |

**Examples:**

- Deposit funds to the signer's address:

```
> recall account deposit 10

{
  "transactionHash": "0xcc7fdf8057dd9f024582b24fce2abe0f5e0c01f1e925fb52bd002c4456333bfc",
  "transactionIndex": "0x2",
  "blockHash": "0xdc623f489bb53aaa16186818858c63a5e4e694ed1b798fddae9f96b8d16b4e4b",
  "blockNumber": "0x18b456",
  "from": "0x181c2d11DbB674147Ba53F2cf26Cf6DF9d9cc0aC",
  "to": "0x728f3b71ebd1358973abce325fe45f7f701ea7e6",
  "cumulativeGasUsed": "0x0",
  "gasUsed": "0x41a8748",
  "contractAddress": null,
  "logs": [
    {
      "address": "0x728f3b71ebd1358973abce325fe45f7f701ea7e6",
      "topics": [
        "0xfdd39ce2560484814971f663392e78ae37dc62ba184b3370d830371dd271a8b7",
        "0x000000000000000000000000fdf8c3fb4af3b0c60f7128d2dce1281fdfa9ca6d"
      ],
      "data": "0x0000...",
      "blockHash": "0xdc623f489bb53aaa16186818858c63a5e4e694ed1b798fddae9f96b8d16b4e4b",
      "blockNumber": "0x18b456",
      "transactionHash": "0xcc7fdf8057dd9f024582b24fce2abe0f5e0c01f1e925fb52bd002c4456333bfc",
      "transactionIndex": "0x2",
      "logIndex": "0x0",
      "removed": false
    }
  ],
  "status": "0x1",
  "root": "0x0000000000000000000000000000000000000000000000000000000000000000",
  "logsBloom": "0xffaf...",
  "type": "0x2",
  "effectiveGasPrice": "0x6fbefce0"
}
```

- Deposit funds to some other, non-signer address:

```
> recall account deposit --to 0x181c2d11DbB674147Ba53F2cf26Cf6DF9d9cc0aC 10
```

### Withdraw funds

Withdraw funds from a subnet to its parent.

```
recall account withdraw [--to <TO>] <AMOUNT>
```

The `withdraw` command is the opposite of a `deposit`. It moves funds from a subnet to its parent,
which happens through a smart contract call that unlocks the funds in the smart contract on the
parent. Note that the global `--network` flag (defaults to `testnet`) will set all of the
`--evm-...` presets for you, but you _can_ override them with your own values, if needed.

| Positionals | Description             |
| ----------- | ----------------------- |
| `<AMOUNT>`  | The amount to transfer. |

Similarly, you can pass the `--to` flag to withdraw subnet funds to a specific address on the
parent, but if you don't, the funds will be withdrawn to the address corresponding to the provided
private key.

| Flag                   | Required? | Description                                                                       |
| ---------------------- | --------- | --------------------------------------------------------------------------------- |
| `-p, --private-key`    | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions.                   |
| `--to <TO>`            | No        | The recipient account address (if not present, defaults to the signer's address). |
| `--evm-rpc-url`        | No        | The Ethereum API RPC HTTP endpoint.                                               |
| `--evm-rpc-timeout`    | No        | Timeout for calls to the Ethereum API (default: `60 seconds`).                    |
| `--evm-rpc-auth-token` | No        | Bearer token for any Authorization header.                                        |
| `--evm-gateway`        | No        | The gateway contract address.                                                     |
| `--evm-registry`       | No        | The registry contract address.                                                    |

**Examples:**

- Withdraw funds to the signer's address:

```
> recall account withdraw 10

{
  "transactionHash": "0xb098e39c4b358e5f55cd6f2db941092ff50b46d99db53c34101cac3f0f65f20d",
  "transactionIndex": "0x0",
  "blockHash": "0x3ebcd0c3b94a5076fffbeef95fd23cdd764a222679450e451dac6ce28b601eb2",
  "blockNumber": "0x19532",
  "from": "0x181c2d11DbB674147Ba53F2cf26Cf6DF9d9cc0aC",
  "to": "0x77aa40b105843728088c0132e43fc44348881da8",
  "cumulativeGasUsed": "0x5e63fa3",
  "gasUsed": "0x5e63fa3",
  "contractAddress": null,
  "logs": [],
  "status": "0x1",
  "root": "0x341c4ad32b230e66cdc5bf75e522934defa276afb88d705ce52a34336655b3a1",
  "logsBloom": "0x0000...",
  "type": "0x2",
  "effectiveGasPrice": "0x0"
}
```

- Withdraw funds to some other, non-signer address:

```
> recall account withdraw --to 0x181c2d11DbB674147Ba53F2cf26Cf6DF9d9cc0aC 10
```

### Transfer funds

Transfer funds to another account within a subnet.

```
recall account transfer --to <TO> <AMOUNT>
```

| Positionals | Description             |
| ----------- | ----------------------- |
| `<AMOUNT>`  | The amount to transfer. |

The `--to` flag is the destination address within the subnet that you want to send funds to. Note
that the global `--network` flag (defaults to `testnet`) will set all of the `--evm-...` presets for
you, but you _can_ override them with your own values, if needed. This transaction happens fully
_within_ the subnet (and does not interact with the rootnet).

| Flag                   | Required? | Description                                                     |
| ---------------------- | --------- | --------------------------------------------------------------- |
| `-p, --private-key`    | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions. |
| `--to <TO>`            | Yes       | The recipient account address.                                  |
| `--evm-rpc-url`        | No        | The Ethereum API RPC HTTP endpoint.                             |
| `--evm-rpc-timeout`    | No        | Timeout for calls to the Ethereum API (default: `60 seconds`).  |
| `--evm-rpc-auth-token` | No        | Bearer token for any Authorization header.                      |
| `--evm-gateway`        | No        | The gateway contract address.                                   |
| `--evm-registry`       | No        | The registry contract address.                                  |

**Example:**

```
> recall account transfer \
--to 0x4D5286d81317E284Cd377cB98b478552Bbe641ae \
10

{
  "transactionHash": "0x814759e167906ffc65dd20c6ceb4cdd42e5f64f9af7ca5bcd2ac1ea365ce715d",
  "transactionIndex": "0x0",
  "blockHash": "0xf496f8f9bdfb909696513411f01abd72184446a9c846f6016a85c9601294d4d0",
  "blockNumber": "0x1a7d2",
  "from": "0x181c2d11DbB674147Ba53F2cf26Cf6DF9d9cc0aC",
  "to": "0x4d5286d81317e284cd377cb98b478552bbe641ae",
  "cumulativeGasUsed": "0x18f28a",
  "gasUsed": "0x18f28a",
  "contractAddress": null,
  "logs": [],
  "status": "0x1",
  "root": "0x05b06003f5986d96409d53af89e0d1ad44b8f8487254beb6bef20cda0d7e0874",
  "logsBloom": "0x0000...",
  "type": "0x2",
  "effectiveGasPrice": "0x410"
}
```

<Callout type="info">

When you `transfer` funds from an account that already exists on the subnet to an account that
doesn't exist, the recipient will effectively be created. Thus, it's much faster (a couple of
seconds) than a `deposit` or `withdraw`, which require a two-step process that eventually settles on
the rootnet.

</Callout>

### Sponsor

Set or unset an account's default credit sponsor for gas fees. This assumes the sponsor has approved
your account via a credit approval.

```
recall account sponsor <SUBCOMMAND>
```

| Subcommand | Description                                             |
| ---------- | ------------------------------------------------------- |
| `set`      | Set an account's default credit sponsor for gas fees.   |
| `unset`    | Unset an account's default credit sponsor for gas fees. |

In each command, it takes the following positionals:

| Positionals | Description             |
| ----------- | ----------------------- |
| `<SPONSOR>` | Credit sponsor address. |

**Examples:**

Both of these examples presume the account `0x15d34aaf54267db7d7c367839aaf71a00a2c6a65` has executed
a [credit approval](#approve-credit) for your account.

- Set an account's default credit sponsor for gas fees.

```
recall account sponsor set 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65
```

- Unset an account's default credit sponsor for gas fees.

```
recall account sponsor unset 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65
```

## Credit

Manage credits for your account and sponsoring storage for contracts.

```
recall credit <SUBCOMMAND>
```

### Buy credit

Buy credits for an account.

```
recall credit buy <AMOUNT>
```

| Positionals | Description                                                       |
| ----------- | ----------------------------------------------------------------- |
| `<AMOUNT>`  | The amount of credits to purchase using the subnet's native coin. |

| Flag                   | Required? | Description                                                                           |
| ---------------------- | --------- | ------------------------------------------------------------------------------------- |
| `-p, --private-key`    | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions.                       |
| `--to <TO>`            | No        | The recipient account address (if not present, defaults to the signer's address).     |
| `-b, --broadcast-mode` | No        | Broadcast mode for the transaction: `commit`, `sync`, or `async` (default: `commit`). |
| `--gas-limit`          | No        | Gas limit for the transaction.                                                        |
| `--gas-fee-cap`        | No        | Maximum gas fee for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL).             |
| `--gas-premium`        | No        | Gas premium for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL).                 |
| `--sequence`           | No        | Sequence (i.e., nonce) for the transaction.                                           |

You'll see three values in the `data` field of the response:

- `credit_free`: The number of credits available to spend—equivalent to the amount of credits
  purchased and not yet committed to storing data.
- `credit_committed`: The number of credits committed to storing data.
- `last_debit_epoch`: The epoch (block height) at which the account last had credits debited.

**Example:**

- Buy credits with 1 native coins (displayed with $10^(18)$ units).

```
> recall credit buy 1

{
  "status": "committed",
  "hash": "842AAC5A189543486B00D7A4FC594477C0E9F63623EA677B5AC85F27568BC31A",
  "height": "791907",
  "gas_used": 11114885,
  "data": {
    "credit_free": "1000000000000000000.0",
    "credit_committed": "0",
    "credit_sponsor": null,
    "last_debit_epoch": 14400,
    "approvals": {},
    "gas_allowance": "1.0"
  }
}
```

### Approve credit

Approve a credit amount for a bucket.

```
recall credit approve [OPTIONS] --to <TO>
```

| Flag                | Required? | Description                                                                                                            |
| ------------------- | --------- | ---------------------------------------------------------------------------------------------------------------------- |
| `-p, --private-key` | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions.                                                        |
| `--to <TO>`         | Yes       | The receiver account address.                                                                                          |
| `--limit <LIMIT>`   | No        | Credit approval limit. If specified, the approval becomes invalid once the committed credits reach the specified limit |
| `--ttl <TTL>`       | No        | Credit approval time-to-live epochs. If specified, the approval becomes invalid after this duration                    |

**Example:**

- Approve a receiver to use credits for any buckets created by the approver (i.e., the account
  making the approval).

```
> recall credit approve --to 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65

{
  "status": "committed",
  "hash": "F84A5A4B78ACF7D88010F0C6C78ADB6D4643FB246E06502B16C265B91F5780B0",
  "height": "15139",
  "gas_used": 9956584,
  "data": {
    "credit_used": "0.0",
    "gas_fee_used": "0.0"
  }
}
```

- Approve a receiver to use credits for a specific bucket.

```
> recall credit approve \
--to 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65
```

- Approve a receiver to use credits with both a TTL and a credit limit.

```
> recall credit approve \
--to 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65 \
--ttl 3600 \
--limit 10

{
  "status": "committed",
  "hash": "858EA764A6D739B2285D05FE582ECD53B55D3162A363AC025219D337D16741E6",
  "height": "15255",
  "gas_used": 12041282,
  "data": {
    "limit": "10",
    "expiry": 18855,
    "committed": "0"
  }
}
```

### Revoke credit

Revoke a credit amount for a bucket.

```
recall credit revoke [OPTIONS] --to <TO>
```

| Flag                | Required? | Description                                                     |
| ------------------- | --------- | --------------------------------------------------------------- |
| `-p, --private-key` | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions. |
| `--to <TO>`         | Yes       | The receiver account address.                                   |

**Example:**

- Revoke a receiver's approval, disabling credit usage.

```
> recall credit revoke --to 0x15d34aaf54267db7d7c367839aaf71a00a2c6a65

{
  "status": "committed",
  "hash": "DA227ABACDCC9CDD559547485F106D79BAB81E0A93C3789B8E0A5AF23617D0A5",
  "height": "15287",
  "gas_used": 10150699
}
```

### Get credit balance

Get the credit balance for an account.

```
recall credit balance
```

| Flag                | Required?                | Description                                                           |
| ------------------- | ------------------------ | --------------------------------------------------------------------- |
| `-p, --private-key` | Yes, if no `address`     | Wallet private key (ECDSA, secp256k1) for signing transactions.       |
| `-a, --address`     | Yes, if no `private-key` | Account address; the signer's address is used if no address is given. |
| `--height`          | No                       | Query at a specific block height (default: `committed`).              |

- **Example:**

```
> recall credit balance

{
  "credit_free": "1000000000000000000.0",
  "credit_committed": "0.0",
  "credit_sponsor": "0x90f79bf6eb2c4f870365e785982e1f101e93b906",
  "last_debit_epoch": 15000,
  "approvals": {
    "0x9965507d1a55bcc2695c58ba16fb37d819b0a4dc": {
      "credit_used": "0.0",
      "gas_fee_used": "0.0"
    }
  },
  "gas_allowance": "1.0"
}
```

### Get credit stats

Get the credit stats for a subnet.

```
recall credit stats
```

This is more of a subnet-wide view, as opposed to an account-specific view. It's helpful because it
shows the total number of credits sold and committed, number of accounts that have bought credits,
and the credit debit rate.

| Flag       | Required? | Description                                              |
| ---------- | --------- | -------------------------------------------------------- |
| `--height` | No        | Query at a specific block height (default: `committed`). |

**Example:**

```
> recall credit stats

{
  "balance": "50000.199999787752056",
  "credit_sold": "50000200000000000000000.0",
  "credit_committed": "493182.0",
  "credit_debited": "25218.0",
  "token_credit_rate": 1000000000000000000.0,
  "num_accounts": 10
}
```

## Storage information

Get the storage stats and information.

```
recall storage
```

### Get storage usage

Get the storage usage for an account.

```
recall storage usage
```

| Flag                | Required?                | Description                                                           |
| ------------------- | ------------------------ | --------------------------------------------------------------------- |
| `-p, --private-key` | Yes, if no `address`     | Wallet private key (ECDSA, secp256k1) for signing transactions.       |
| `-a, --address`     | Yes, if no `private-key` | Account address; the signer's address is used if no address is given. |
| `--height`          | No                       | Query at a specific block height (default: `committed`).              |

The response will define `capacity_used` in bytes.

- **Example:**

```
> recall storage usage

{
  "capacity_used": "0"
}
```

### Subnet storage stats

Get the storage stats for a subnet.

```
recall storage stats
```

This is a subnet-wide view that describes the total amount of storage available and the amount of
storage that is currently in use.

| Flag       | Required? | Description                                              |
| ---------- | --------- | -------------------------------------------------------- |
| `--height` | No        | Query at a specific block height (default: `committed`). |

The response includes the following values:

- `capacity_free`: The total free capacity in bytes (e.g., 1073741824 bytes = 1 GiB).
- `capacity_used`: The total used capacity in bytes.
- `num_blobs`: The total number of blobs in the subnet.
- `num_resolving`: The total number of resolving (non-expiry) blobs in the subnet.

**Example:**

```
> recall storage stats

{
  "capacity_free": "10995116277754",
  "capacity_used": "6",
  "num_blobs": 1,
  "num_resolving": 0,
  "num_accounts": 10,
  "bytes_resolving": 0,
  "num_added": 0,
  "bytes_added": 0
}
```

## Contracts

Contracts are the core building blocks of the Recall network. The `machine` command allows you to
retrieve data contract information relative to a specific address. This helps track which bucket or
timehub contracts are tied to your account, which are later used in the `bucket` and `timehub`
subcommands described below.

### Get contract info

Get contract metadata at a specific address.

```
recall machine info <ADDRESS>
```

| Positionals | Description       |
| ----------- | ----------------- |
| `<ADDRESS>` | Contract address. |

| Flag       | Required? | Description                                              |
| ---------- | --------- | -------------------------------------------------------- |
| `--height` | No        | Query at a specific block height (default: `committed`). |

**Example:**

```
> recall machine info 0xff00000000000000000000000000000000000094

{
  "kind": "Bucket",
  "owner": "0x4d5286d81317e284cd377cb98b478552bbe641ae",
  "metadata": {
    "alias": "foo"
  }
}
```

## Buckets

Interact with a bucket contract using either the `bucket` or aliased `bu` subcommand:

```
recall bucket <SUBCOMMAND>
recall bu <SUBCOMMAND>
```

The `bucket` subcommand has the following subcommands:

- `create`: Create a new bucket contract.
- `list`: List buckets by owner in a subnet.
- `add`: Add an object into the bucket.
- `get`: Get an object from the bucket.
- `delete`: Delete an object from the bucket.
- `query`: Query objects in the bucket.
- `metadata`: Set new metadata for an object.

When you create objects, the `key` is a custom identifier that, by default, uses the `/` delimiter
to create a key-based hierarchy. The value is the data you want to store, which can be a file path.
A best practice is to decide on a key naming convention that makes sense for your data, such as
`<namespace>/<id>` or similar. The hierarchical structure of the key allows for easy retrieval of
data by prefixes, which is explained below (see the `query` subcommand).

### Create

Create a new Bucket contract.

```
recall bucket create
```

| Flag                | Required? | Description                                                               |
| ------------------- | --------- | ------------------------------------------------------------------------- |
| `-p, --private-key` | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions.           |
| `-m, --metadata`    | No        | User-defined metadata.                                                    |
| `--buy-credit`      | No        | The amount of tokens to spend on credit for the bucket.                   |
| `--gas-limit`       | No        | Gas limit for the transaction.                                            |
| `--gas-fee-cap`     | No        | Maximum gas fee for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL). |
| `--gas-premium`     | No        | Gas premium for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL).     |
| `--sequence`        | No        | Sequence (i.e., nonce) for the transaction.                               |

**Example:**

- Create a new bucket contract.

```
> recall bucket create

{
  "address": "0xff00000000000000000000000000000000000094",
  "tx": {
    "hash": "EC2ADFDD47F7E740C417E3BAEF2240CD5431C57F3389BF80A4B219D7B1486000",
    "height": "789471",
    "gas_used": 18058885
  }
}
```

- Create a new bucket contract with metadata.

```
> recall bucket create --metadata "alias=foo"
```

### List buckets

List buckets by owner in a subnet.

```
recall bucket list {--private-key <PRIVATE_KEY> | --address <ADDRESS>}
```

You must pass _either_ the `--private-key` or `--address` flag. An address must be in the delegated
`t410` or `0x` format.

- `recall bucket list --private-key <PRIVATE_KEY>`: Query with a private key (or read from your
  `.env` file).
- `recall bucket list --address <ADDRESS>`: Query a `t410` or `0x` address.

| Flag                | Required?                | Description                                                           |
| ------------------- | ------------------------ | --------------------------------------------------------------------- |
| `-p, --private-key` | Yes, if no `address`     | Wallet private key (ECDSA, secp256k1) for signing transactions.       |
| `-a, --address`     | Yes, if no `private-key` | Account address; the signer's address is used if no address is given. |
| `--height`          | No                       | Query at a specific block height (default: `committed`).              |

**Examples:**

Query data contracts by:

- A hex address:

```
> recall bucket list \
--address 0x4D5286d81317E284Cd377cB98b478552Bbe641ae

[
  {
    "address": "0xff00000000000000000000000000000000000094",
    "kind": "Bucket",
    "metadata": {
      "alias": "foo"
    }
  }
]
```

- At a specific block height (note how at this older height, there were fewer data contracts created
  than the most recent `committed` height above):

```
> recall bucket list --height 789471
```

### Add an object

Add an object with a key prefix.

```
recall bucket add \
--address <ADDRESS> \
--key <KEY> \
<FILE_PATH>
```

| Positionals   | Description          |
| ------------- | -------------------- |
| `<FILE_PATH>` | File path to upload. |

You _must_ set the bucket address and object key. The metadata, ttl, and overwrite flags are
optional but useful in various scenarios.

| Flag                   | Required? | Description                                                                           |
| ---------------------- | --------- | ------------------------------------------------------------------------------------- |
| `-p, --private-key`    | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions.                       |
| `-a, --address`        | Yes       | Bucket contract address.                                                              |
| `-k, --key`            | Yes       | Key of the object to upload.                                                          |
| `-m, --metadata`       | No        | User-defined metadata.                                                                |
| `--ttl`                | No        | Object time-to-live (TTL) duration.                                                   |
| `-o, --overwrite`      | No        | Overwrite the object if it already exists.                                            |
| `-b, --broadcast-mode` | No        | Broadcast mode for the transaction: `commit`, `sync`, or `async` (default: `commit`). |
| `--gas-limit`          | No        | Gas limit for the transaction.                                                        |
| `--gas-fee-cap`        | No        | Maximum gas fee for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL).             |
| `--gas-premium`        | No        | Gas premium for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL).                 |
| `--sequence`           | No        | Sequence (i.e., nonce) for the transaction.                                           |

**Examples:**

Push a file to the bucket—and note the path must be absolute. We can create a file with the
following contents:

```
echo '{"hello":"world"}' > ~/hello.json
```

- Add the file to the bucket:

```
> recall bucket add \
--address 0xff00000000000000000000000000000000000094 \
--key "hello/world" \
~/hello.json

{
  "status": "committed",
  "hash": "48BD1767DC5739C1EABB25FBC8E6718E3E8DE95FB7EE74D13895F2E9D9F5E00A",
  "height": "358569",
  "gas_used": 4784697,
  "data": "bafy2bzacebnjpu5e3ushfu2weqvmtvk7vnndg4fkqsbr4zub52cyekcix7l4o"
}
```

- Include metadata in the object along with ttl and overwrite:

```
> recall bucket add \
--address 0xff00000000000000000000000000000000000094 \
--key "hello/world" \
--metadata "alias=foo" \
--ttl 3600 \
--overwrite \
~/hello.json
```

### Get an object

Get an object from the bucket contract.

```
recall bucket get --address <ADDRESS> <KEY>
```

| Positionals | Description               |
| ----------- | ------------------------- |
| `<KEY>`     | Key of the object to get. |

Note that when you retrieve the object, it will be written to stdout.

| Flag               | Required? | Description                                                                                                   |
| ------------------ | --------- | ------------------------------------------------------------------------------------------------------------- |
| `-a, --address`    | Yes       | Bucket contract address.                                                                                      |
| `--object-api-url` | No        | Node Object API URL.                                                                                          |
| `--range`          | No        | Range of bytes to get from the object (format: `"start-end"`; inclusive). Example: "0-99" => first 100 bytes. |
| `--height`         | No        | Query at a specific block height (default: `committed`).                                                      |

**Examples:**

- Get an object and write to stdout (default behavior):

```
> recall bucket get \
--address 0xff00000000000000000000000000000000000094 \
"hello/world"

{"hello":"world"}
```

- Download the output to a file by piping the output:

```
> recall bucket get \
--address 0xff00000000000000000000000000000000000094 \
"hello/world" > downloaded.json
```

- Range request for a subset of bytes:

```
> recall bucket get \
--address 0xff00000000000000000000000000000000000094 \
--range "10-14" \
"hello/world"

world
```

### Delete an object

Delete an object from the bucket.

```
recall bucket delete \
--address <ADDRESS> \
<KEY>
```

| Positionals | Description               |
| ----------- | ------------------------- |
| `<KEY>`     | Key of the object to get. |

Similar to when you `add` an object, you can specify gas settings or alter the broadcast mode.

| Flag                   | Required? | Description                                                                           |
| ---------------------- | --------- | ------------------------------------------------------------------------------------- |
| `-p, --private-key`    | Yes       | Wallet private key (ECDSA, secp256k1) for signing transactions.                       |
| `-a, --address`        | Yes       | Bucket contract address.                                                              |
| `--object-api-url`     | No        | Node Object API URL.                                                                  |
| `-b, --broadcast-mode` | No        | Broadcast mode for the transaction: `commit`, `sync`, or `async` (default: `commit`). |
| `--gas-limit`          | No        | Gas limit for the transaction.                                                        |
| `--gas-fee-cap`        | No        | Maximum gas fee for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL).             |
| `--gas-premium`        | No        | Gas premium for the transaction in attoFIL (1FIL = 10\*\*18 attoFIL).                 |
| `--sequence`           | No        | Sequence (i.e., nonce) for the transaction.                                           |

**Example:**

- Delete an existing object:

```
> recall bucket delete \
--address 0xff00000000000000000000000000000000000094 \
"hello/world"

{
  "status": "committed",
  "hash": "C718E2E7A4BC4DC0E6AB705698E8950CE3EBEADEC3268206145E5A109E76FBB4",
  "height": "358561",
  "gas_used": 4739569,
  "data": "bafy2bzaceamp42wmmgr2g2ymg46euououzfyck7szknvfacqscohrvaikwfay"
}
```

### Query objects

Query across all objects in the store.

```
recall bucket query --address <ADDRESS>
```

Performing a `query` lists all keys that match a given prefix _up to and including the delimiter_.
If the key supplies a delimiter, then the results stop there—essentially, listing subfolders, but
none lower. Think of it as you would when listing files in a directory. If you list the contents of
a folder, you'll see all subfolders, but you won't see the contents of one of those subfolders.

For example, if you have the keys `hello/world`, `hello/data`, and `hello/world/child`, and you
query for the prefix `hello/`, you will get the objects at `hello/world` and `hello/data` but not
`hello/world/child` since its "nested" under the prefix `hello/world/` (note: inclusive of the `/`
at the end).

| Flag              | Required? | Description                                                                        |
| ----------------- | --------- | ---------------------------------------------------------------------------------- |
| `-a, --address`   | Yes       | Bucket contract address.                                                           |
| `-p, --prefix`    | No        | The prefix to filter objects by (defaults to empty string).                        |
| `-d, --delimiter` | No        | The delimiter used to define object hierarchy (default: `/`).                      |
| `-o, --offset`    | No        | The offset from which to start listing objects (default: `0`)                      |
| `-l, --limit`     | No        | The maximum number of objects to list, where `0` indicates max (10k)(default: `0`) |
| `--height`        | No        | Query at a specific block height (default: `committed`).                           |

**Examples:**

- Get all objects but without any filtering. Since the object keys have a delimiter included, you'll
  see the common prefix `hello/`, but no objects are listed since the "root" is the prefix:

```
> recall bucket query \
--address 0xff00000000000000000000000000000000000094

{
  "objects": [],
  "common_prefixes": [
    "hello/"
  ]
}
```

- Get all objects under a specific prefix. In this case, the response will include all objects under
  the `hello/` prefix, and since there are no "child" objects that match `hello/` (e.g.,
  `hello/world/child`), the `common_prefixes` array will be empty, so you know there are no more
  sub-objects to list:

```
> recall bucket query \
--address 0xff00000000000000000000000000000000000094 \
--prefix "hello/"

{
  "objects": [
    {
      "key": "hello/world",
      "value": {
        "hash": "cuk3b7gp7d5epf6ybuw4wzyr7jnqufzpjbhh7p6st6wxhooufzxq",
        "recovery_hash": "64g5u27toipv52hjbs4p34nvis2v3zkslr7lgzliocsz3gzzddoa",
        "size": 18,
        "expiry": 15408,
        "metadata": {
          "content-type": "application/octet-stream"
        }
      }
    }
  ],
  "common_prefixes": []
}
```

- Get all objects and "ignore" the delimiter. Here, an arbitrary `"*"` symbol is used as the
  delimiter; it's been chosen since it doesn't exist in the example's keys that are used. Thus, this
  effectively lists all objects in the store because the delimiter isn't in the keys, so the
  `common_prefixes` array will be empty. The response will be the same as above.

```
> recall bucket query \
--address 0xff00000000000000000000000000000000000094 \
--delimiter "*"
```

- Get all objects and filter by a prefix with offset and limit. In the example above, lets say a
  `"hello/data"` object was created _after_ `"hello/world"`. When we query the bucket, it will be
  the first object listed since we're offsetting by `1`:

```
> recall bucket query \
--address 0xff00000000000000000000000000000000000094 \
--delimiter "/" \
--prefix "hello/" \
--offset 1 \
--limit 1

{
  "objects": [
    {
      "key": "hello/data",
      "value": {
        "hash": "cuk3b7gp7d5epf6ybuw4wzyr7jnqufzpjbhh7p6st6wxhooufzxq",
        "recovery_hash": "64g5u27toipv52hjbs4p34nvis2v3zkslr7lgzliocsz3gzzddoa",
        "size": 18,
        "expiry": 15408,
        "metadata": {
          "content-type": "application/octet-stream"
        }
      }
    }
  ],
  "common_prefixes": []
}
```

### Add metadata to an object

Add metadata to an existing object.

```
recall bucket metadata --address <ADDRESS> --key <KEY> --metadata <METADATA>
```

| Flag             | Required? | Description                           |
| ---------------- | --------- | ------------------------------------- |
| `-a, --address`  | Yes       | Bucket contract address.              |
| `-k, --key`      | Yes       | Key of the object to add metadata to. |
| `-m, --metadata` | Yes       | Metadata to add to the object.        |

**Example:**

- Add metadata to an existing object:

```
> recall bucket metadata \
--address 0xff00000000000000000000000000000000000094 \
--key "hello/world" \
--metadata "alias=foo"

{
  "status": "committed",
  "hash": "468D11CEC52D0AC4418459C6E10DFE6A6A0DC294EA7E79BA9E1BA479E4B7A44F",
  "height": "15730",
  "gas_used": 6805233
}
```

Then, when you query the object, you'll see the metadata is now in the object.

## Timehub

Timehubs are an anchoring service, separate from Basin. You can interact with a timehub contract
using either the `timehub` or aliased `th` subcommand:

```
recall timehub <SUBCOMMAND>
recall th <SUBCOMMAND>
```

The `timehub` subcommand has the following subcommands:

- `create`: Create a new timehub.
- `list`: List timehubs.
- `push`: Push a value.
- `leaf`: Get leaf at a given index and height.
- `count`: Get leaf count at a given height.
- `peaks`: Get peaks at a given height.
- `root`: Get root at a given height.
- `help`: Print this message or the help of the given subcommand(s).

<Callout type="info">

The timehub usage is a work in progress and will be updated in the future. It's fully functional, so
feel free to follow the commands above as desired.

</Callout>
