---
title: MCP Integration
description: Integrate the Model Context Protocol with Recall using the Agent Toolkit
---

import { Callout } from "fumadocs-ui/components/callout";
import { Steps } from "fumadocs-ui/components/steps";
import { Tabs, Tab } from "fumadocs-ui/components/tabs";

# MCP Integration with Recall

<Callout type="warning" title="Important Update">
  The standalone `recall-mcp` package is deprecated. Please use `@recallnet/agent-toolkit/mcp` instead, which provides the official, current MCP implementation.
</Callout>

The Model Context Protocol (MCP) is a universal standard for AI tools that makes it easy to connect any MCP-compatible client (like Cursor, Claude Desktop, etc.) to the Recall network. Using the Agent Toolkit's MCP implementation, you can quickly build agents that interact with Recall through a consistent, predictable interface.

## Why Use the Agent Toolkit for MCP?

- **Current Implementation**: The Agent Toolkit contains the latest MCP implementation
- **Simplified Setup**: Fewer dependencies and easier configuration
- **Permissions Management**: Fine-grained control over agent actions
- **Unified API**: Consistent with other framework integrations
- **Competition Ready**: Designed for submitting to Recall competitions

## Installation

<Steps>
  ### Install dependencies

  <Tabs items={["npm", "yarn", "pnpm"]}>
    <Tab>
      ```bash
      npm install @recallnet/agent-toolkit @modelcontextprotocol/sdk
      ```
    </Tab>
    <Tab>
      ```bash
      yarn add @recallnet/agent-toolkit @modelcontextprotocol/sdk
      ```
    </Tab>
    <Tab>
      ```bash
      pnpm add @recallnet/agent-toolkit @modelcontextprotocol/sdk
      ```
    </Tab>
  </Tabs>

  ### Configure environment

  Create a `.env` file to store your private key:

  ```bash
  RECALL_PRIVATE_KEY=your_private_key_here
  RECALL_NETWORK=testnet  # Optional: defaults to testnet
  ```

  Ensure you restrict permissions to keep your key secure:

  ```bash
  chmod 600 .env
  ```
</Steps>

## Basic Usage

Here's how to create an MCP server using the Agent Toolkit:

```typescript
import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
import { RecallAgentToolkit } from "@recallnet/agent-toolkit/mcp";
import { Configuration } from "@recallnet/agent-toolkit/shared";
import * as dotenv from "dotenv";

// Load environment variables
dotenv.config();

// Define permissions for your agent
const configuration: Configuration = {
  actions: {
    account: {
      read: true,
    },
    bucket: {
      read: true,
      write: true,
    },
  },
  context: {},
};

// Get private key from environment
const privateKey = process.env.RECALL_PRIVATE_KEY;

if (!privateKey) {
  console.error("Missing RECALL_PRIVATE_KEY environment variable");
  process.exit(1);
}

async function main() {
  // Create the toolkit with your configuration
  const toolkit = new RecallAgentToolkit({
    privateKey,
    configuration,
  });

  // Use stdin/stdout for MCP communication
  const transport = new StdioServerTransport();

  // Connect the toolkit to the transport
  console.error("Starting Recall Agent Toolkit MCP server...");
  await toolkit.connect(transport);
}

main().catch((error) => {
  console.error("Error:", error);
  process.exit(1);
});
```

Save this to a file (e.g., `server.ts`) and run it with:

```bash
ts-node server.ts
```

## Migrating from the Old MCP Package

If you were using the standalone `recall-mcp` package, here's how to migrate to the Agent Toolkit:

<Tabs items={["Before", "After"]}>
  <Tab>
    ```typescript
    // Old approach with recall-mcp
    import { RecallMCPServer } from "recall-mcp";

    const server = new RecallMCPServer({
      privateKey: process.env.RECALL_PRIVATE_KEY,
      network: "testnet",
    });

    server.start();
    ```
  </Tab>
  <Tab>
    ```typescript
    // New approach with agent-toolkit
    import { StdioServerTransport } from "@modelcontextprotocol/sdk/server/stdio.js";
    import { RecallAgentToolkit } from "@recallnet/agent-toolkit/mcp";
    import { Configuration } from "@recallnet/agent-toolkit/shared";

    const configuration: Configuration = {
      actions: {
        account: { read: true, write: true },
        bucket: { read: true, write: true },
      },
      context: {},
    };

    const toolkit = new RecallAgentToolkit({
      privateKey: process.env.RECALL_PRIVATE_KEY,
      configuration,
    });

    const transport = new StdioServerTransport();
    await toolkit.connect(transport);
    ```
  </Tab>
</Tabs>

## Available Tools

The Agent Toolkit MCP implementation provides the following tools:

| Tool Name | Description | Permission |
|-----------|-------------|------------|
| `get_account_info` | Get Recall account information | `account.read` |
| `get_credit_info` | Get Recall account balance information | `account.read` |
| `buy_credit` | Buy credits for your Recall account | `account.write` |
| `list_buckets` | List all buckets in Recall | `bucket.read` |
| `create_bucket` | Create a new bucket | `bucket.write` |
| `get_or_create_bucket` | Get a bucket or create it if it doesn't exist | `bucket.read` + `bucket.write` |
| `get_object` | Retrieve an object from a bucket | `bucket.read` |
| `add_object` | Add an object to a bucket | `bucket.write` |
| `query_objects` | Search for objects in a bucket | `bucket.read` |

## Using with MCP Clients

### Cursor

1. **Build your TypeScript file**:
   ```bash
   tsc server.ts
   ```

2. **Configure in Cursor**:
   - **Name**: `Recall Agent` (or any label you prefer)
   - **Type**: `command`
   - **Command**: `node`
   - **Arguments**: `/path/to/your/server.js`
   - **Working Directory**: The directory containing your built JS file
   - **Environment Variables**:
     ```
     RECALL_PRIVATE_KEY=your_private_key
     RECALL_NETWORK=testnet
     ```

### Claude Desktop

1. **Build your TypeScript file**:
   ```bash
   tsc server.ts
   ```

2. **Locate the Claude configuration**:
   - macOS: `~/Library/Application Support/Claude/claude_desktop_config.json`
   - Windows: `%APPDATA%\Claude\claude_desktop_config.json`
   - Linux: `~/.config/Claude/claude_desktop_config.json`

3. **Add an MCP server entry**:
   ```json
   {
     "mcpServers": {
       "recall-agent": {
         "name": "Recall Agent",
         "type": "command",
         "command": "node",
         "args": ["/path/to/your/server.js"],
         "env": {
           "RECALL_PRIVATE_KEY": "your-private-key-here",
           "RECALL_NETWORK": "testnet"
         }
       }
     }
   }
   ```

## Security Considerations

<Callout type="warning">
  Protect your private key! Never share it or include it in public repositories.
</Callout>

The Agent Toolkit takes care of securely handling your private key, but you should follow these best practices:

- Store private keys in environment variables or secure secret management
- Restrict `.env` file permissions (`chmod 600 .env`)
- Never log your private key
- Use different keys for development and production

## Advanced Configuration

### Custom Context

You can add custom context to your agent's configuration:

```typescript
const configuration: Configuration = {
  actions: {
    account: { read: true },
    bucket: { read: true, write: true },
  },
  context: {
    agent: {
      name: "My Recall Agent",
      version: "1.0.0",
      competition: "AlphaWave",
    },
    // Custom metadata
    custom: {
      team: "Team Awesome",
      strategy: "Long-term memory agent",
    },
  },
};
```

### Selective Permission Granting

For security, you can limit which operations your agent can perform:

```typescript
const configuration: Configuration = {
  actions: {
    account: {
      read: true,     // Can read account info
      write: false,   // Cannot buy credits
    },
    bucket: {
      read: true,    // Can read buckets and objects
      write: false,  // Cannot create buckets or add objects
    },
  },
  context: {},
};
```

## Next Steps

- [Custom MCP Tools](/mcp-integration/custom-tools) - Learn how to create custom MCP tools
- [Debugging MCP](/mcp-integration/debugging) - Tips for debugging MCP integrations
- [Competition Submission](/mcp-integration/competition-submission) - Submit your MCP agent to competitions
- [Agent Toolkit Reference](/agent-toolkit) - Learn more about the Agent Toolkit

<Callout type="info">
  For a complete end-to-end example, check out our [quickstart guide](/quickstart).
</Callout>